<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"meetabs.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="My Notes">
<meta property="og:url" content="https://meetabs.github.io/page/11/index.html">
<meta property="og:site_name" content="My Notes">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="meetabs">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://meetabs.github.io/page/11/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/11/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>My Notes</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">My Notes</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="meetabs"
      src="/images/500px-linux-header-picture.png">
  <p class="site-author-name" itemprop="name">meetabs</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://meetabs.github.io/2022/11/12/onenote/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/500px-linux-header-picture.png">
      <meta itemprop="name" content="meetabs">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My Notes">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | My Notes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/12/onenote/" class="post-title-link" itemprop="url">OneNote</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-11-12 00:00:00" itemprop="dateCreated datePublished" datetime="2022-11-12T00:00:00+00:00">2022-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OneNote/" itemprop="url" rel="index"><span itemprop="name">OneNote</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="源码编译"><a href="#源码编译" class="headerlink" title="源码编译"></a>源码编译</h4><h5 id="编译安装squid"><a href="#编译安装squid" class="headerlink" title="编译安装squid"></a>编译安装squid</h5><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">./configure <span class="attribute">--prefix</span>=/usr <span class="attribute">--localstatedir</span>=/var <span class="attribute">--libexecdir</span>=<span class="variable">$&#123;prefix&#125;</span>/lib/squid </span><br><span class="line"><span class="attribute">--datadir</span>=<span class="variable">$&#123;prefix&#125;</span>/share/squid <span class="attribute">--sysconfdir</span>=/etc/squid </span><br><span class="line"><span class="attribute">--with-default-user</span>=proxy <span class="attribute">--with-logdir</span>=/var/log/squid </span><br><span class="line"><span class="attribute">--with-pidfile</span>=/var/run/squid.pid </span><br><span class="line">--with-openssl --enable-ssl --enable-ssl-crtd</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>ubuntu22.04系统需要自己编译openssl_v1.1后再编译squid, 对应的选项</p>
<figure class="highlight brainfuck"><table><tr><td class="code"><pre><span class="line"><span class="literal">--</span><span class="comment">with</span><span class="literal">-</span><span class="comment">openssl</span> <span class="literal">--</span><span class="comment">enable</span><span class="literal">-</span><span class="comment">ssl</span> <span class="literal">--</span><span class="comment">enable</span><span class="literal">-</span><span class="comment">ssl</span><span class="literal">-</span><span class="comment">crtd</span></span><br></pre></td></tr></table></figure>

<p>修改成</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">--with-openssl=<span class="regexp">/usr/</span>local<span class="regexp">/openssl_1.1/</span> --enable-ssl --enable-ssl-crtd</span><br></pre></td></tr></table></figure>

<p>systemctl cat squid </p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /etc/systemd/system/squid.service </span></span><br><span class="line"><span class="comment">## Copyright (C) 1996-2020 The Squid Software Foundation and contributors </span></span><br><span class="line"><span class="comment">## </span></span><br><span class="line"><span class="comment">## Squid software is distributed under GPLv2+ license and includes </span></span><br><span class="line"><span class="comment">## contributions from numerous individuals and organizations. </span></span><br><span class="line"><span class="comment">## Please see the COPYING and CONTRIBUTORS files for details. </span></span><br><span class="line"><span class="comment">## </span></span><br><span class="line"><span class="section">[Unit]</span> </span><br><span class="line"><span class="attr">Description</span>=Squid Web Proxy Server </span><br><span class="line"><span class="attr">Documentation</span>=man:squid(<span class="number">8</span>) </span><br><span class="line"><span class="attr">After</span>=network.target network-<span class="literal">on</span>line.target nss-lookup.target </span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span> </span><br><span class="line"><span class="attr">Type</span>=forking </span><br><span class="line"><span class="attr">PIDFile</span>=/var/run/squid.pid </span><br><span class="line"><span class="attr">ExecStartPre</span>=/usr/sbin/squid --foreground -z </span><br><span class="line"><span class="attr">ExecStart</span>=/usr/sbin/squid -sYC </span><br><span class="line"><span class="attr">ExecReload</span>=/bin/kill -HUP <span class="variable">$MAINPID</span> </span><br><span class="line"><span class="attr">KillMode</span>=mixed </span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span> </span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target </span><br></pre></td></tr></table></figure>
<h5 id="ubuntu20-04编译Linux-5-15-41"><a href="#ubuntu20-04编译Linux-5-15-41" class="headerlink" title="ubuntu20.04编译Linux 5.15.41"></a>ubuntu20.04编译Linux 5.15.41</h5><p>安装依赖 </p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">sudo apt <span class="keyword">install </span>git fakeroot <span class="keyword">build-essential </span>ncurses-dev xz-utils libssl-dev <span class="keyword">bc </span>flex libelf-dev <span class="keyword">bison </span></span><br><span class="line">sudo apt <span class="keyword">install </span>dwarves </span><br><span class="line">sudo apt <span class="keyword">install </span>zstd </span><br></pre></td></tr></table></figure>
<p>拷贝当前内核的配置文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cp</span> /boot/config-$(<span class="built_in">uname</span> -r) .config </span><br></pre></td></tr></table></figure>
<p>配置编译选项, 可以直接save &amp;&amp; exit</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">make menuconfig</span><br><span class="line">scripts<span class="built_in">/config </span>--<span class="built_in">disable</span> SYSTEM_REVOCATION_KEYS</span><br><span class="line">scripts<span class="built_in">/config </span>--<span class="built_in">disable</span> SYSTEM_TRUSTED_KEYS</span><br></pre></td></tr></table></figure>
<p>编译内核</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> modules_install</span><br><span class="line">sudo <span class="built_in">make</span> install</span><br></pre></td></tr></table></figure>


<h4 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h4><h5 id="kvm-bridge网络配置"><a href="#kvm-bridge网络配置" class="headerlink" title="kvm bridge网络配置"></a>kvm bridge网络配置</h5><p>①删除kvm默认网桥。</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">virsh net-destroy <span class="keyword">default</span> </span><br><span class="line">virsh net-undefine <span class="keyword">default</span> </span><br></pre></td></tr></table></figure>
<p>②更改host主机系统网络配置。</p>
<img src="/images/onenote/onenote_01_20221112.png" style="margin:0px"/>

<p>③创建虚拟机, 网络选择刚创建的bridge-kvm。<br><img src="/images/onenote/onenote_02_20221112.png" style="margin:0px"/></p>
<h5 id="win10虚拟机添加物理分区-virtio驱动-读写性能高"><a href="#win10虚拟机添加物理分区-virtio驱动-读写性能高" class="headerlink" title="win10虚拟机添加物理分区(virtio驱动, 读写性能高)"></a>win10虚拟机添加物理分区(virtio驱动, 读写性能高)</h5><p>安装virtio驱动有两种方案:</p>
<figure class="highlight nsis"><table><tr><td class="code"><pre><span class="line">①安装<span class="literal">win10</span>虚拟机的时候就带上virtio驱动， 这样<span class="literal">win10</span>虚拟机本身的启动盘也是virtio类型， 性能最佳 </span><br><span class="line">②<span class="literal">win10</span>已经安装后可以挂载virtio-win-<span class="number">0.1</span>.<span class="number">215</span>.iso, 运行里面的setup.exe， 安装驱动后重启，</span><br><span class="line">   这里需要注意的是版本太新可能会安装失败。推荐virtio-win-<span class="number">0.1</span>.<span class="number">215</span>.iso </span><br></pre></td></tr></table></figure>
<p>驱动安装后即可添加本地磁盘(virtio方式, 否则只能SATA方式性能较低) 。ls -l &#x2F;dev&#x2F;disk&#x2F;by-id&#x2F; 结合 df -h得到需要添加的物理分区编号。<br><img src="/images/onenote/onenote_07_20221113.png" style="margin:0px"/></p>
<p>添加硬件, 磁盘。</p>
<img src="/images/onenote/onenote_08_20221113.png" style="margin:0px"/>
<img src="/images/onenote/onenote_09_20221113.png" style="margin:0px"/>

<p>这里介绍安装virtio驱动的第一种方法。</p>
<p>①安装win10时， 启动盘就选择virtio。<br><img src="/images/onenote/onenote_10_20221113.png" style="margin:0px"/></p>
<p>②这种方式安装win10时需要额外添加一个CD&#x2F;DVD, 加载virtio-win-0.1.215.iso, 不然没法识别virtio硬盘。<br><img src="/images/onenote/onenote_11_20221113.png" style="margin:0px"/></p>
<p>③加载驱动， 识别硬盘，然后安装win10系统 。<br><img src="/images/onenote/onenote_12_20221113.png" style="margin:0px"/></p>
<img src="/images/onenote/onenote_13_20221113.png" style="margin:0px"/>
  
<img src="/images/onenote/onenote_14_20221113.png" style="margin:0px"/>
 
<p>然后就可以识别virtio硬盘， 安装常规方式安装系统。<br><img src="/images/onenote/onenote_15_20221113.png" style="margin:0px"/></p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">参考文章:</span><br><span class="line">https:<span class="regexp">//</span>linuxhint.com<span class="regexp">/install_virtio_drivers_kvm_qemu_windows_vm/</span> </span><br><span class="line">https:<span class="regexp">//</span>access.redhat.com<span class="regexp">/documentation/</span>en-us<span class="regexp">/red_hat_enterprise_linux/</span><span class="number">6</span><span class="regexp">/html/</span>virtualization_host_configuration_and_guest_installation_guide/form-virtualization_host_configuration_and_guest_installation_guide-para_virtualized_drivers-mounting_the_image_with_virt_manager </span><br></pre></td></tr></table></figure>
<h5 id="kvm虚拟机添加串口设备"><a href="#kvm虚拟机添加串口设备" class="headerlink" title="kvm虚拟机添加串口设备"></a>kvm虚拟机添加串口设备</h5><p>①虚拟机添加完成后默认会生成一个serial设备。<br><img src="/images/onenote/onenote_16_20221113.png" style="margin:0px"/></p>
<p>②虚拟机内部开机自启动串口ttyS0设备。</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">systemctl <span class="keyword">enable</span> <span class="type">serial</span>-getty@ttyS0.service </span><br><span class="line">systemctl <span class="keyword">start</span> <span class="type">serial</span>-getty@ttyS0.service </span><br></pre></td></tr></table></figure>

<p>③更改grub文件, 指定串口输出(&#x2F;etc&#x2F;default&#x2F;grub)。</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX_DEFAULT<span class="operator">=</span><span class="string">&quot;console=tty0 console=ttyS0&quot;</span> </span><br><span class="line">GRUB_TERMINAL<span class="operator">=</span><span class="string">&quot;serial console&quot;</span> </span><br><span class="line">update-grub2 </span><br></pre></td></tr></table></figure>
<p>④宿主机用命令连接到串口。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">virsh</span> list </span><br><span class="line"><span class="attribute">virsh</span> console ubuntu20.<span class="number">04</span> </span><br></pre></td></tr></table></figure>
<img src="/images/onenote/onenote_17_20221113.png" style="margin:0px"/>

<h5 id="kvm-虚拟机使用usb设备"><a href="#kvm-虚拟机使用usb设备" class="headerlink" title="kvm 虚拟机使用usb设备"></a>kvm 虚拟机使用usb设备</h5><p>①为虚拟机的usb设备设置为usb3。<br><img src="/images/onenote/onenote_04_20221113.png" style="margin:0px"/></p>
<p>②使用USB功能重定向即可， virt-manager菜单：Virtual Machine -&gt; Redirect USB Device<br><img src="/images/onenote/onenote_05_20221113.png" style="margin:0px"/></p>
<p>③查看Windows Guest我的电脑。<br><img src="/images/onenote/onenote_06_20221113.png" style="margin:0px"/></p>
<h5 id="pve安装openwrt"><a href="#pve安装openwrt" class="headerlink" title="pve安装openwrt"></a>pve安装openwrt</h5><p>①解压openwrt-<em>-combined-squashfs.img.gz文件, 得到openwrt-</em>-combined-squashfs.img, 上传到pve主机。<br>②分离pve默认创建的硬盘后, 点击“删除”该硬盘。<br>③ssh登录到pve的后台, 把img导入100编号的虚拟机。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">qm</span> importdisk <span class="number">100</span> ./openwrt-*-combined-squashfs.img local-lvm </span><br></pre></td></tr></table></figure>
<p>⑤然后进入openwrt虚拟机的硬件设置, 选中未使用的磁盘0 -&gt;  编辑 -&gt; 弹出窗口默认配置, 直接点击添加。<br>  <img src="/images/onenote/onenote_03_20221112.png" style="margin:0px"/></p>
<h5 id="docker部署rsshub"><a href="#docker部署rsshub" class="headerlink" title="docker部署rsshub"></a>docker部署rsshub</h5><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">不包括puppeteer</span><br><span class="line">docker <span class="built_in">run</span> -d --name rsshub -p 1200:1200 -e <span class="attribute">HTTP_BASIC_AUTH_NAME</span>=username  -e <span class="attribute">HTTP_BASIC_AUTH_PASS</span>=password  diygod/rsshub</span><br><span class="line"></span><br><span class="line">包括puppeteer</span><br><span class="line">docker <span class="built_in">run</span> -d --name rsshub -p 1200:1200 -e <span class="attribute">HTTP_BASIC_AUTH_NAME</span>=username  -e <span class="attribute">HTTP_BASIC_AUTH_PASS</span>=password  diygod/rsshub:chromium-bundled</span><br></pre></td></tr></table></figure>

<h5 id="ubuntu22-04安装搜狗输入法"><a href="#ubuntu22-04安装搜狗输入法" class="headerlink" title="ubuntu22.04安装搜狗输入法"></a>ubuntu22.04安装搜狗输入法</h5><p>安装搜狗输入法官方包后需要再安装对应依赖。</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">sudo apt install libqt5qml5 libqt5quick5 libqt5quickwidgets5 qml-<span class="keyword">module</span>-qtquick2 libgsettings-qt1 </span><br></pre></td></tr></table></figure>

<h5 id="批量修改文件和文件夹权限"><a href="#批量修改文件和文件夹权限" class="headerlink" title="批量修改文件和文件夹权限"></a>批量修改文件和文件夹权限</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> d -<span class="built_in">exec</span> <span class="built_in">chmod</span> 0755 &#123;&#125; \;</span><br><span class="line">find . -<span class="built_in">type</span> f -<span class="built_in">exec</span> <span class="built_in">chmod</span> 0644 &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<h5 id="dnsmasq搭建dns服务器"><a href="#dnsmasq搭建dns服务器" class="headerlink" title="dnsmasq搭建dns服务器"></a>dnsmasq搭建dns服务器</h5><p>①关闭系统自带的绑定53端口。<br>vim &#x2F;etc&#x2F;systemd&#x2F;resolved.conf</p>
<figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line">DNSStubListener=<span class="literal">no</span> </span><br><span class="line">This will <span class="keyword">switch</span> <span class="literal">off</span> binding <span class="keyword">to</span> port <span class="number">53.</span> </span><br></pre></td></tr></table></figure>

<p>②cloudflare官方教程链接。</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//</span>developers.cloudflare.com<span class="regexp">/1.1.1.1/</span>encryption<span class="regexp">/dns-over-https/</span>dns-over-https-client/ </span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">sudo tee /etc/systemd/system/cloudflared-proxy-dns.service &gt;/dev/<span class="literal">null</span> &lt;&lt;EOF</span><br><span class="line"></span><br><span class="line">[Unit] </span><br><span class="line"><span class="attribute">Description</span>=DNS over HTTPS (DoH)<span class="built_in"> proxy client </span></span><br><span class="line"><span class="attribute">Wants</span>=network-online.target nss-lookup.target </span><br><span class="line"><span class="attribute">Before</span>=nss-lookup.target </span><br><span class="line"></span><br><span class="line">[Service] </span><br><span class="line"><span class="attribute">AmbientCapabilities</span>=CAP_NET_BIND_SERVICE </span><br><span class="line"><span class="attribute">CapabilityBoundingSet</span>=CAP_NET_BIND_SERVICE </span><br><span class="line"><span class="attribute">DynamicUser</span>=<span class="literal">yes</span> </span><br><span class="line"><span class="attribute">ExecStart</span>=/usr/local/bin/cloudflared proxy-dns --address 0.0.0.0 --port 5553 </span><br><span class="line"></span><br><span class="line">[Install] </span><br><span class="line"><span class="attribute">WantedBy</span>=multi-user.target </span><br><span class="line">EOF </span><br></pre></td></tr></table></figure>
<h5 id="wireguard-Linux客户端"><a href="#wireguard-Linux客户端" class="headerlink" title="wireguard Linux客户端"></a>wireguard Linux客户端</h5><p>安装依赖</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">apt <span class="keyword">install</span> resolvconf</span><br></pre></td></tr></table></figure>
<p>把服务器上生成的client配置文件放到&#x2F;etc&#x2F;wireguad目录，配置文件名称必须以.conf结尾(wg0对应配置文件: wg0.conf)。有两种方式可以启动：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">①systemd管理客户端</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> wg-quick@wg0</span><br><span class="line">sudo systemctl start wg-quick@wg0</span><br><span class="line"></span><br><span class="line">②手动启动客户端</span><br><span class="line">sudo wg <span class="built_in">set</span> wg0<span class="built_in"> peer </span>&lt;Client Public Key&gt; endpoint &lt;Client<span class="built_in"> IP </span>address&gt;:51820 allowed-ips 10.10.10.2/24</span><br><span class="line">sudo wg</span><br></pre></td></tr></table></figure>
<h4 id="Issues"><a href="#Issues" class="headerlink" title="Issues"></a>Issues</h4><h5 id="BTF-tmp-vmlinux-btf-pahole-pahole-is-not-available"><a href="#BTF-tmp-vmlinux-btf-pahole-pahole-is-not-available" class="headerlink" title="BTF: .tmp_vmlinux.btf: pahole (pahole) is not available"></a>BTF: .tmp_vmlinux.btf: pahole (pahole) is not available</h5><figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line"><span class="symbol">BTF:</span> .tmp_vmlinux.btf: pahole (pahole) <span class="built_in">is</span> <span class="built_in">not</span> available</span><br><span class="line">Failed <span class="keyword">to</span> generate BTF <span class="keyword">for</span> vmlinux</span><br><span class="line"><span class="keyword">Try</span> <span class="keyword">to</span> disable CONFIG_DEBUG_INFO_BTF</span><br><span class="line"><span class="symbol">make:</span> *** [Makefile:<span class="number">1106</span>: vmlinux] <span class="keyword">Error</span> <span class="number">1</span></span><br><span class="line">解决办法: sudo apt install dwarves </span><br></pre></td></tr></table></figure>


<h4 id="手机刷机"><a href="#手机刷机" class="headerlink" title="手机刷机"></a>手机刷机</h4><h5 id="ubuntu线刷miui"><a href="#ubuntu线刷miui" class="headerlink" title="ubuntu线刷miui"></a>ubuntu线刷miui</h5><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">①安装adb和fastboot</span><br><span class="line">sudo apt install android-sdk-platform-tools</span><br><span class="line"></span><br><span class="line">②手机fastboot模式下连接到电脑，输入命令查看是否连接好设备<span class="built_in">(root</span>权限)</span><br><span class="line">sudo fastboot devices</span><br><span class="line"></span><br><span class="line">③解压线刷包，执行刷机脚本<span class="built_in">(root</span>权限)</span><br><span class="line">sudo ./flash_all.sh</span><br></pre></td></tr></table></figure>
<h5 id="twrp卡刷miui"><a href="#twrp卡刷miui" class="headerlink" title="twrp卡刷miui"></a>twrp卡刷miui</h5><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">①手机进入fastboot模式， 连接到电脑 </span><br><span class="line"></span><br><span class="line">②刷入TWRP的recovery </span><br><span class="line">sudo fastboot flash recovery twrp-<span class="number">3.6</span>.<span class="number">1</span>_9-<span class="number">0</span>-dipper<span class="selector-class">.img</span></span><br><span class="line"></span><br><span class="line">③重启到recovery模式 </span><br><span class="line">sudo fastboot oem reboot-recovery</span><br><span class="line"></span><br><span class="line">④双清甚至三清</span><br><span class="line"></span><br><span class="line">⑤adb上传卡刷包到手机sdcard目录 </span><br><span class="line">adb push ./xiaomi<span class="selector-class">.eu_multi_MI8_V12</span>.<span class="number">5.2</span>.<span class="number">0</span><span class="selector-class">.QEACNXM_v12-10</span><span class="selector-class">.zip</span> /sdcard/</span><br><span class="line"></span><br><span class="line">⑥recovery里面卡刷即可 </span><br><span class="line">注意：有的刷机包和recovery都支持sideload的话可以adb sideload 刷机</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/39/">39</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa-solid fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">meetabs</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
